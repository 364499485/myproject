
	<div id="bgg">
		<section>
		<div id="center">
			<div class="t1 mr">
				<p class="xbt" style="margin-top:2px;">
					<img src="img/lb.png" alt="">
				</p>	
				<a href="#" class="gg">最新公告</a>
				<div class="title">
					<nav id="ssss">
						<!--<a href="#" class="gg_22" title=""></a>-->
						<!--<span class="time"></span>-->
					</nav>
				</div>
				<a href="#" class="gd" title="更多公告">|&nbsp;&nbsp;更多</a>
			</div>
			<div class="t1 t2">
				<p class="xbt" style="margin-top:3px;">
					<img src="img/ej.png" alt="">
				</p>
				<a href="#" class="gg">最新答疑</a>
				<div class="title">
					<nav id="sss">
						<!--<a href="#" class="gg_1" title=""></a>-->
					</nav>
				</div>
				<a href="#" class="gd" title="更多答疑">|&nbsp;&nbsp;更多</a>
			</div>
			<nav></nav>
		</div>
		<div class="flex">
			<ul>
				<li>
					<p class="tu">
						<img src="img/key1.png" alt="" title="项目安全">
					</p>
					<div>
						<a href="#" style="font-size:25px; color:#33AAFF;" title="项目安全">项目安全</a>
						<p>
							<a href="#">严选刚需行业，优选龙头<br>企业</a>
						</p>
					</div>
				</li>
				<li>
					<p class="tu">
						<img src="img/key2.png" alt="" title="本息安全">
					</p>
					<div>
						<a href="#" style="font-size:25px;color:#33AAFF;" title="本息安全">本息安全</a>
						<p>
							<a href="#">优质核心企业担保，动态<br>大数据贷后</a>
						</p>
					</div>
				</li>
				<li>
					<p class="tu">
						<img src="img/key3.png" alt="" title="运营安全">
					</p>
					<div>
						<a href="#" style="font-size:25px;color:#33AAFF;" title="运营安全">运营安全</a>
						<p>
							<a href="#">零逾期 零坏账，信息披露<br>全透明，无资金池，不自<br>融自担</a>
						</p>
					</div>
				</li>
			</ul>
			<div class="footer">
				<p class="xbt">
					<img src="img/s.png" style="margin-top:5px;" alt="">
				</p>
				<p><a href="#">实时数据</a></p>
				<p class="jy">
					<span>总投资金额</span>
					<canvas width="110" height="24" id="d1" style="margin: 0; margin-top: 10px"></canvas>
					<p>元</p>
				</p>
				<p>
					<span>已发放收益</span>
					<canvas width="110" height="24" id="d2" style="margin: 0; margin-top: 10px"></canvas>
				<p style="margin-left: -10px">元</p>
				</p>
				<p>
					<span>已还本金额</span>
					<canvas width="110" height="24" id="d3" style="margin: 0; margin-top: 10px"></canvas>
				<p style="margin-left: -10px">元</p>
				</p>
				<p>到期本息兑付率 <span class="red"></span></span></p>
			</div>
		</div>
	</section>	
	</div>
	<script>
        //发送请求获取公告数据
        $.ajax({
            url:"http://localhost:3000/notice/list",
            type:"get",
            dataType:"json"
        })
            .then(result=>{
                var html="";
                // console.log(result);
                for(var i=0;i<result.length;i++){
                    html+=`<a href="#" class="gg_22" title="">${result[i].title_1}</a>
						<span class="time">${result[i].add_tm.slice(0,9)}</span>`;
                    // console.log(result[i].add_tm.slice(0,9))
				};
                var nav = document.getElementById("ssss");
                nav.innerHTML=html;
                //设置a标签的title
                for(var j=0;j<result.length;j++){
                    document.querySelectorAll(".gg_22")[j].title = result[j].title;
                }
                //封装定时器的执行函数
                var x =0;
                function fun () {
                    x-=20;
                    nav.style.marginTop=x+"px";
                    nav.style.transition="all .5s linear";
                    if (x == -120) {
                        x=0;
                        nav.style.transition="none";
                        nav.style.marginTop=x+"px";
                    }
                }
                //调用定时器
                var t = setInterval(fun,2000);
                //停止定时器
                nav.onmouseover =function(e){
                    // var xx = e.target;
                    // console.log(xx);
                    clearInterval(t);
                };
                nav.onmouseout =function(){
                    t = setInterval(fun,2000);
                };
            });


  //2....发送请求获取问题数据
        $.ajax({
            url: "http://localhost:3000/notice/problemlist",
            type: "get",
            dataType: "json"
        })
            .then(result => {
                // console.log(result);
                var html = "";
                //循环生成a标签
                for (var i = 0; i < result.length; i++) {
                    html += `<a href="http://localhost:3000/problem.html?id=${result[i].id}" class="gg_1" title="">${result[i].title_1}</a>`;
                }
                var nav = document.getElementById("sss");
                //添加到nav中
                nav.innerHTML = html;
                //设置a标签的title
                for (var s = 0; s < result.length; s++) {
                    document.querySelectorAll(".gg_1")[s].title = result[s].title;
                }
                //封装定时器的执行函数-->
                var x = 0;
                var length = result.length*20;
                function fun() {
                    x -= 20;
                    nav.style.marginTop = x + "px";
                    nav.style.transition = "all .5s linear";
                    if (x == -length) {
                        x = 0;
                        nav.style.transition = "none";
                        nav.style.marginTop = x + "px";
                    }
                }

                //调用定时器-->
                var t = setInterval(fun, 2000);
                //停止定时器-->
                nav.onmouseover = function (e) {
                    // var xx = e.target;
                    // console.log(xx);
                    clearInterval(t);
                };
                nav.onmouseout = function () {
                    t = setInterval(fun, 2000);
                };
            });

//获取资金状态
       function je(d,num) {
           // console.log(d1)
           var ctx = d.getContext("2d");
           var str = 1;
           ctx.fillStyle = "red";
           ctx.font = "18px sans-serif";
           ctx.fillText(str, 0, 15);
           var tt = setInterval(function () {
               ctx.clearRect(0, 0, 100, 30);
               str *= 3;
               ctx.fillText(str, 20, 15);
               if (str >= num) {
                   str = num;
                   ctx.clearRect(0, 0, 113, 30);
                   ctx.fillText(str, 0, 15);
                   clearInterval(tt);
               }
           }, 100);
       }
		$.ajax({
			url:"http://localhost:3000/notice/realtmlist",
			type:"GET",
            dataType: "json"
		})
			.then(result=>{
			     console.log(result);
				//总金额
                var d1 = document.getElementById("d1");
                //console.log(d1)
                je(d1,result[0].totalSum);
				//发放收益
				var d2 = document.getElementById("d2");
				je(d2,result[0].hbTraded);
				//本金
				var d3 = document.getElementById("d3");
				je(d3,result[0].repayment);
				document.querySelector(".red").innerHTML=result[0].exchange;
			})
	</script>



